{"version":3,"sources":["components/Animations/Ellipsis.module.scss","components/SudokuScanner.module.scss","services/TextReader/TextReader.ts","App.module.scss","components/Camera.module.scss","components/Overlay.module.scss","components/SudokuSolver.module.scss","components/Animations/LoadingBlocks.module.scss","components/Camera.tsx","util/camera.ts","util/browser.ts","util/geometry.ts","services/lib/cv.ts","services/SudokuScanner/SudokuScanner.ts","hooks/useScanner.ts","components/Animations/Ellipsis.tsx","components/Animations/LoadingBlocks.tsx","components/SudokuScanner.tsx","hooks/useReader.ts","components/SudokuSolver.tsx","components/Overlay.tsx","App.tsx","reportWebVitals.ts","serviceWorkerRegistration.ts","index.tsx"],"names":["module","exports","TextReader","config","scheduler","language","threadCount","whitelist","single","getTesseractConfig","scriptDir","process","tesseractConfig","user_defined_dpi","tessedit_ocr_engine_mode","tessedit_pageseg_mode","undefined","tessedit_char_whitelist","workerConfig","isNode","langPath","path","join","__dirname","cacheMethod","gzip","workerPath","corePath","this","createScheduler","addThread","a","worker","createWorker","load","loadLanguage","initialize","setParameters","addWorker","Promise","allSettled","Array","fill","map","imageSource","addJob","text","data","slice","length","terminate","CameraStatus","idealCameraConstraints","width","ideal","height","facingMode","focusMode","whiteBalance","exposureMode","identifyPrimaryCamera","navigator","mediaDevices","enumerateDevices","inputDevices","cameras","filter","device","kind","Error","backFacingCameras","camera","label","includes","turnOnCamera","videoElement","dimensions","constraints","video","deviceId","audio","getUserMedia","srcObject","play","Camera","forwardRef","ref","onStatusUpdate","useEffect","current","catch","name","Denied","Unavailable","getVideoTracks","stop","className","styles","onLoadedMetadata","Active","onSuspend","playsInline","muted","browser","detect","scriptTimeout","parseFloat","loadScript","url","timeout","script","document","createElement","defer","startsWith","src","body","appendChild","resolve","reject","timeoutId","window","setTimeout","addEventListener","clearTimeout","loadMobileConsole","eruda","init","distance","x1","y1","x2","y2","closest","reference","points","distances","point","closestDistance","reduce","closestPoint","i","measureSides","coords","coord","isPointInsideRect","rect","x","y","getContourPathCoords","contour","pointVector","from","data32S","simplifyContour","simplified","cv","Mat","epsilon","arcLength","approxPolyDP","isContourSquarish","container","minSize","maxSize","size","minArea","Math","min","rows","cols","sizeLimit","max","contourArea","sortedLengths","sort","longest","pop","every","cropAndFlatten","rectangleContour","sourceWidth","sourceHeight","contourCoords","topLeft","topRight","bottomLeft","bottomRight","newWidth","newHeight","flattened","zeros","CV_8UC3","Size","srcTri","matFromArray","CV_32FC2","dstTri","transformMatrix","getPerspectiveTransform","warpPerspective","INTER_LINEAR","BORDER_CONSTANT","delete","split","columns","squares","squareWidth","squareHeight","r","c","crop","Rect","roi","cropCellBorders","binary","cellCenter","round","cellArea","maxArea","contours","MatVector","hierarchy","findContours","RETR_TREE","CHAIN_APPROX_SIMPLE","largestArea","largestRect","get","boundingRect","area","shapeRatio","binaryCellContents","isCellEmpty","mean","CV_64F","stdDev","meanStdDev","doubleAt","isEmpty","padding","SudokuScanner","source","preprocess","blurRadius","thresholdBlur","thresholdNorm","original","processed","constructor","matFromImageData","imread","clone","outputCanvas","preprocessImage","largestSquare","findLargestSquare","colour","imshow","extractSudokuImage","extractDigits","originalCells","binaryCells","grid","row","colourCell","binaryCell","digitMat","canvas","push","cvtColor","COLOR_RGBA2GRAY","blurKernel","GaussianBlur","BORDER_DEFAULT","adaptiveThreshold","ADAPTIVE_THRESH_MEAN_C","THRESH_BINARY","timeLimit","buffer","getFrame","mask","getBoundingClientRect","displayWidth","displayHeight","cover","videoWidth","videoHeight","scaledWidth","scaledHeight","cropX","cropY","scale","videoMask","offsetLeft","offsetTop","offsetWidth","offsetHeight","ctx","getContext","drawImage","getImageData","Ellipsis","one","two","three","LoadingBlocks","loadingBlocks","block1","block2","block3","block4","block5","block6","block7","block8","block9","onFound","scanHz","canvasRef","useRef","output","useState","scannerLoaded","setScannerLoaded","digitImages","setDigitImages","scanSource","useCallback","start","Date","now","found","frame","scanner","SudokuScannerService","destruct","timeTaken","loadDependencies","then","useScanner","readerLoaded","setReaderLoaded","sudoku","setSudoku","digitReader","useMemo","readPendingDigits","all","digit","read","useReader","loadingMessage","sudokuScanner","SudokuSolver","sudokuSolver","cell","Overlay","corners","overlay","role","corner","top","left","right","bottom","App","Loading","cameraStatus","setCameraStatus","videoRef","app","type","onClick","href","target","rel","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","search","os","style","serviceWorker","ready","registration","unregister","error","console","message"],"mappings":"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","file":"static/js/main.4ff0261c.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"one\":\"Ellipsis_one__zElG3\",\"ellipsis\":\"Ellipsis_ellipsis__3jNN6\",\"two\":\"Ellipsis_two__2xLtj\",\"three\":\"Ellipsis_three__3hdzz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"SudokuScanner_app__39mV1\",\"sudokuScanner\":\"SudokuScanner_sudokuScanner__3ToCZ\",\"loadingMessage\":\"SudokuScanner_loadingMessage__1RgGF\"};","import isNode from 'detect-node';\nimport path from 'path';\nimport {\n  createScheduler,\n  createWorker,\n  ImageLike,\n  PSM,\n  RecognizeResult,\n  Scheduler,\n  WorkerOptions,\n  WorkerParams,\n} from 'tesseract.js';\n\nimport TextReaderInterface, { TextReaderConfig } from '../../types/interfaces/TextReader';\n\nexport default class TextReader implements TextReaderInterface {\n  protected readonly scheduler: Scheduler;\n  protected readonly language = 'eng';\n  protected readonly config: TextReaderConfig = {\n    /** 2 threads seems a good compromise on mobile devices */\n    threadCount: 2, // TODO: Dynamically determine optimal thread count.\n    whitelist: '',\n    single: false,\n  };\n\n  constructor(config?: Partial<TextReaderConfig>) {\n    this.config = { ...this.config, ...config };\n    this.scheduler = createScheduler();\n  }\n\n  /** @inheritDoc */\n  public async load(): Promise<void> {\n    const { workerConfig, tesseractConfig } = this.getTesseractConfig();\n    const addThread = async () => {\n      const worker = createWorker(workerConfig);\n\n      await worker.load();\n      await worker.loadLanguage(this.language);\n      await worker.initialize(this.language);\n      await worker.setParameters(tesseractConfig);\n\n      this.scheduler.addWorker(worker);\n    };\n\n    await Promise.allSettled(Array(this.config.threadCount).fill(0).map(addThread));\n  }\n\n  /** @inheritDoc */\n  public async read(imageSource: ImageLike): Promise<string> {\n    const {\n      data: { text },\n    } = (await this.scheduler.addJob('recognize', imageSource)) as RecognizeResult;\n\n    // Tesseract always appends a newline, and sometimes returns multiple chars in single-char mode!\n    return text.slice(0, this.config.single ? 1 : text.length - 1);\n  }\n\n  /** @inheritDoc */\n  public async destruct() {\n    await this.scheduler.terminate();\n  }\n\n  /**\n   * \"Translates\" our configuration into Tesseract's.\n   */\n  protected getTesseractConfig = () => {\n    const tesseractConfig: Partial<WorkerParams> = {\n      user_defined_dpi: '300',\n      tessedit_ocr_engine_mode: 2,\n      tessedit_pageseg_mode: this.config.single ? ('10' as PSM) : undefined,\n      tessedit_char_whitelist: this.config.whitelist || undefined,\n    };\n\n    // Configure Tesseract worker to not make external download requests...\n    const scriptDir = process.env.REACT_APP_PUBLIC_SCRIPT_DIR ?? '';\n    const workerConfig: Partial<WorkerOptions> = isNode\n      ? {\n          langPath: path.join(__dirname, '..', '..', '..', 'public', scriptDir, 'ocr'),\n          // It should be faster to cache the uncompressed lang data, although there seems to be no\n          // real difference in practice; so we may as well keep the repo smaller.\n          cacheMethod: 'none',\n          gzip: true,\n        }\n      : {\n          langPath: `${process.env.PUBLIC_URL}/${scriptDir}/ocr`,\n          workerPath: `${process.env.PUBLIC_URL}/${scriptDir}/ocr/worker.min.js`,\n          corePath: `${process.env.PUBLIC_URL}/${scriptDir}/ocr/tesseract-core.wasm.js`,\n        };\n\n    return { tesseractConfig, workerConfig };\n  };\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__2ziFi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"camera\":\"Camera_camera__1ODM1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"Overlay_app__3lk76\",\"overlay\":\"Overlay_overlay__3vGmN\",\"corner\":\"Overlay_corner__1TZHo\",\"top\":\"Overlay_top__1gty1\",\"left\":\"Overlay_left__3L_DC\",\"right\":\"Overlay_right___Zrwb\",\"bottom\":\"Overlay_bottom__v5eaf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"SudokuSolver_app__oOmwd\",\"sudokuSolver\":\"SudokuSolver_sudokuSolver__10dvD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"LoadingBlocks_app__-G7ER\",\"loadingBlocks\":\"LoadingBlocks_loadingBlocks__WdlnC\",\"load\":\"LoadingBlocks_load__2vBzM\",\"block1\":\"LoadingBlocks_block1__3UdgJ\",\"block2\":\"LoadingBlocks_block2__2F5y7\",\"block3\":\"LoadingBlocks_block3__2dRof\",\"block4\":\"LoadingBlocks_block4__2bBin\",\"block5\":\"LoadingBlocks_block5__3LT2j\",\"block6\":\"LoadingBlocks_block6__1ZCCM\",\"block7\":\"LoadingBlocks_block7__3yVzZ\",\"block8\":\"LoadingBlocks_block8__1q1wE\",\"block9\":\"LoadingBlocks_block9__1MBjw\"};","import { forwardRef, MutableRefObject, useEffect } from 'react';\n\nimport { turnOffCamera, turnOnCamera } from '../util/camera';\nimport styles from './Camera.module.scss';\n\nexport enum CameraStatus {\n  Loading,\n  Active,\n  Denied,\n  Unavailable,\n}\n\n/**\n * Renders a video feed of the user's camera (if one is available, with permission granted).\n */\nconst Camera = forwardRef<HTMLVideoElement, Props>(({ onStatusUpdate }: Props, ref) => {\n  useEffect(() => {\n    const { current } = ref as MutableRefObject<HTMLVideoElement | null>;\n\n    if (!current) return () => {};\n\n    turnOnCamera(current).catch(({ name }) =>\n      onStatusUpdate(name === 'NotAllowedError' ? CameraStatus.Denied : CameraStatus.Unavailable)\n    );\n\n    return () => turnOffCamera(current);\n  }, [onStatusUpdate, ref]);\n\n  return (\n    <video\n      className={styles.camera}\n      ref={ref}\n      onLoadedMetadata={() => onStatusUpdate(CameraStatus.Active)}\n      onSuspend={() => onStatusUpdate(CameraStatus.Unavailable)}\n      playsInline\n      muted\n    />\n  );\n});\n\ntype Props = { onStatusUpdate(status: CameraStatus): void };\nexport default Camera;\n","interface Resolution {\n  width: number;\n  height: number;\n}\n\n/**\n * Used for getting the best-possible camera and configuration from `MediaDevices.getUserMedia()`.\n */\nconst idealCameraConstraints = {\n  width: { ideal: 2048 },\n  height: { ideal: 1080 },\n  facingMode: { ideal: 'environment' },\n  focusMode: { ideal: 'continuous' },\n  whiteBalance: { ideal: 'continuous' },\n  exposureMode: { ideal: 'continuous' },\n};\n\n/**\n * Attempts to find the device's main, telephoto, back-facing camera.\n */\nexport const identifyPrimaryCamera = async (): Promise<MediaDeviceInfo | null> => {\n  const inputDevices = await navigator.mediaDevices.enumerateDevices();\n  const cameras = inputDevices.filter(device => device.kind === 'videoinput');\n\n  if (!cameras.length) throw new Error('No camera found.');\n\n  const backFacingCameras = cameras.filter(camera => camera.label.includes('facing back'));\n\n  // For some reason, on phones with multiple cameras, the last one is usually the main one...\n  return backFacingCameras.length ? backFacingCameras[backFacingCameras.length - 1] : null;\n};\n\n/**\n *  Loads video stream into the supplied <video /> element.\n */\nexport const turnOnCamera = async (videoElement: HTMLVideoElement, dimensions?: Resolution) => {\n  const camera = await identifyPrimaryCamera();\n  const constraints = {\n    video: {\n      ...idealCameraConstraints,\n      // Fall back to the OS-selected camera, if our heuristic can't choose one.\n      deviceId: camera?.deviceId ? camera.deviceId : undefined,\n      ...(dimensions && {\n        width: { ideal: dimensions.width },\n        height: { ideal: dimensions.height },\n      }),\n    },\n    audio: false,\n  };\n\n  videoElement.srcObject = await navigator.mediaDevices.getUserMedia(constraints);\n  await videoElement.play();\n};\n\n/**\n * Ends any streams associated with the <video />, so that the user's camera light turns off.\n */\nexport const turnOffCamera = (videoElement: HTMLVideoElement) => {\n  const stream = videoElement.srcObject as MediaStream;\n  stream.getVideoTracks()[0].stop();\n};\n","import { detect } from 'detect-browser';\n\nexport const browser = detect();\n\nconst scriptTimeout = parseFloat(process.env.REACT_APP_SCRIPT_LOAD_TIMEOUT ?? '') || 10000;\n\n/**\n * Some scripts aren't available on npm, as modules or are simply too big to be bundled, in a\n * browser context; so this function will load them \"the old fashioned way\", via a script element.\n *\n * @param url     The url of the script to load (can be relative or absolute).\n * @param timeout The max amount of time the script can take to load, before throwing an Error.\n */\nexport const loadScript = async (url: string, timeout = scriptTimeout): Promise<void> => {\n  const script = document.createElement('script');\n  script.defer = true;\n\n  if (url.startsWith('http')) script.src = url;\n  else script.src = `${process.env.PUBLIC_URL}/${process.env.REACT_APP_PUBLIC_SCRIPT_DIR}/${url}`;\n\n  document.body.appendChild(script);\n\n  return new Promise((resolve, reject): void => {\n    const timeoutId = window.setTimeout(\n      () => reject(new Error(`${url} failed to load in time`)),\n      timeout\n    );\n\n    script.addEventListener('load', () => {\n      window.clearTimeout(timeoutId);\n      resolve();\n    });\n  });\n};\n\n/**\n * Loads a mobile console that can be very helpful for debugging on mobile devices.\n * (Eruda's npm package unfortunately doesn't export a module, so we have to manually load it like\n * this.)\n */\nexport const loadMobileConsole = async (): Promise<void> => {\n  await loadScript('mobileConsole.js');\n  // @ts-ignore -- eruda will have been defined globally, by the script.\n  eruda.init();\n};\n\n/**\n * @see https://bugs.webkit.org/show_bug.cgi?id=141832\n */\nexport const fixViewportHeightInMobileSafari = (): void => {\n  browser?.os === 'iOS' &&\n    browser.name === 'ios' &&\n    window.addEventListener('resize', () => {\n      document.body.style.height = '100vh';\n    });\n};\n","export type Point = [number, number];\n\ntype Rectangle = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n};\n\nexport const distance = ([x1, y1]: Point, [x2, y2]: Point): number =>\n  ((x1 - x2) ** 2 + (y1 - y2) ** 2) ** (1 / 2);\n\nexport const closest = (reference: Point, points: Point[]): Point => {\n  const distances = points.map(point => distance(reference, point));\n  let closestDistance = distances[0];\n\n  return points.reduce((closestPoint, point, i) => {\n    if (distances[i] < closestDistance) {\n      closestDistance = distances[i];\n      return point;\n    }\n    return closestPoint;\n  });\n};\n\nexport const measureSides = (coords: Point[]): number[] =>\n  coords.map((coord, i) => distance(coord, coords[i < coords.length - 1 ? i + 1 : 0]));\n\nexport const isPointInsideRect = (point: Point, rect: Rectangle) =>\n  point[0] >= rect.x &&\n  point[1] >= rect.y &&\n  point[0] <= rect.x + rect.width &&\n  point[0] <= rect.y + rect.height;\n","import { closest, isPointInsideRect, measureSides, Point } from '../../util/geometry';\n\n/** {@link https://docs.opencv.org/3.4/dc/dcf/tutorial_js_contour_features.html} */\nconst BOX_DETECTION_THRESHOLD = 0.01;\nconst SQUARE_SHAPE_THRESHOLD = 0.7;\nconst MIN_CHAR_AREA = 0.08;\nconst MAX_CHAR_AREA = 0.8;\nconst MIN_CHAR_ASPECT_RATIO = 0.2;\nconst MAX_CHAR_ASPECT_RATIO = 1.6;\n/** The average lightness threshold below which a cell is assumed empty. */\nconst CELL_EMPTY_THRESHOLD = 230;\nconst CHAR_PADDING = 0.05;\n\n/**\n * Because contours are just a list of numbers, e.g. [x1, y1, x2, y2, x3, y3...].\n */\nexport const getContourPathCoords = (contour: cv.Mat): Point[] => {\n  const pointVector = Array.from(contour.data32S);\n  const coords = Array(4);\n  for (let i = 0; i < 4; i++) coords[i] = pointVector.slice(i * 2, i * 2 + 2);\n\n  return coords;\n};\n\n/**\n * Simplifies the shape, reducing its number of sides.\n */\nexport const simplifyContour = (contour: cv.Mat): cv.Mat => {\n  const simplified = new cv.Mat();\n  const epsilon = BOX_DETECTION_THRESHOLD * cv.arcLength(contour, true);\n\n  cv.approxPolyDP(contour, simplified, epsilon, true);\n  return simplified;\n};\n\n/**\n * Returns true if the contour resembles a square (allowing for varied perspective angles and\n * rotation).\n *\n * @param contour\n * @param container The contour's container, to be used as a size reference.\n * @param minSize   The minimum size of the square (relative to container).\n * @param maxSize   The maximum size of the square (relative to container).\n */\nexport const isContourSquarish = (\n  contour: cv.Mat,\n  container?: cv.Mat,\n  minSize = 0,\n  maxSize = 1\n): boolean => {\n  // If we don't have 4 sides, then it's definitely not a square!\n  if (contour.size().height !== 4) return false;\n  // If there are no size constraints to apply...\n  if (!container) return true;\n\n  // Take the smaller of both sides, to allow for wide aspect ratio sources.\n  const minArea = Math.min(container.rows, container.cols) ** 2 * minSize;\n  const sizeLimit = Math.max(container.rows, container.cols) * maxSize;\n\n  if (cv.contourArea(contour) >= minArea) {\n    const coords = getContourPathCoords(contour);\n\n    // Check that all sides are within ~70% of the longest side.\n    const sortedLengths = measureSides(coords).sort();\n    const longest = sortedLengths.pop();\n    if (!longest) return false;\n\n    return (\n      longest < sizeLimit &&\n      sortedLengths.every(length => length > SQUARE_SHAPE_THRESHOLD * longest)\n    );\n  }\n\n  return false;\n};\n\nexport const cropAndFlatten = (src: cv.Mat, rectangleContour: cv.Mat): cv.Mat => {\n  const [sourceWidth, sourceHeight] = [src.cols, src.rows];\n\n  // Find the corners of the contour (this won't work if the grid is too close to 45Â°).\n  const contourCoords = getContourPathCoords(rectangleContour);\n  const topLeft = closest([0, 0], contourCoords);\n  const topRight = closest([sourceWidth, 0], contourCoords);\n  const bottomLeft = closest([0, sourceHeight], contourCoords);\n  const bottomRight = closest([sourceWidth, sourceHeight], contourCoords);\n\n  // Choose the smallest width and side, for the cropped dimensions.\n  const newWidth = Math.min(topRight[0] - topLeft[0], bottomRight[0] - bottomLeft[0]);\n  const newHeight = Math.min(bottomLeft[1] - topLeft[1], bottomRight[1] - topRight[1]);\n  const flattened = cv.Mat.zeros(newWidth, newHeight, cv.CV_8UC3);\n  const size = new cv.Size(newWidth, newHeight);\n\n  // Produce a transformation matrix and apply it to the warp\n  // see: https://docs.opencv.org/3.4/dd/d52/tutorial_js_geometric_transformations.html\n  const srcTri = cv.matFromArray(4, 1, cv.CV_32FC2, [\n    ...topLeft,\n    ...topRight,\n    ...bottomRight,\n    ...bottomLeft,\n  ]);\n  const dstTri = cv.matFromArray(4, 1, cv.CV_32FC2, [\n    0,\n    0,\n    newWidth,\n    0,\n    newWidth,\n    newHeight,\n    0,\n    newHeight,\n  ]);\n  const transformMatrix = cv.getPerspectiveTransform(srcTri, dstTri);\n  cv.warpPerspective(src, flattened, transformMatrix, size, cv.INTER_LINEAR, cv.BORDER_CONSTANT);\n\n  transformMatrix.delete();\n  srcTri.delete();\n  dstTri.delete();\n\n  return flattened;\n};\n\nexport const split = (src: cv.Mat, rows: number, columns: number): cv.Mat[][] => {\n  const squares: cv.Mat[][] = new Array(rows);\n  const squareWidth = src.cols / columns;\n  const squareHeight = src.rows / rows;\n\n  for (let r = 0; r < rows; r++) {\n    squares[r] = new Array(columns);\n    for (let c = 0; c < columns; c++) {\n      const x = c * squareWidth;\n      const y = r * squareHeight;\n      const crop = new cv.Rect(x, y, squareWidth, squareHeight);\n      squares[r][c] = src.roi(crop);\n    }\n  }\n\n  return squares;\n};\n\nexport const isEmpty = (src: cv.Mat) => {\n  const mean = new cv.Mat(1, 4, cv.CV_64F);\n  const stdDev = new cv.Mat(1, 4, cv.CV_64F);\n  cv.meanStdDev(src, mean, stdDev);\n\n  return mean.doubleAt(0, 0) >= CELL_EMPTY_THRESHOLD;\n};\n\n/**\n * Tesseract is notoriously bad at extracting text from table cells; so we need help it out, by\n * cropping the cell's contents to remove any edges (which can be mistaken for characters).\n */\nexport const cropCellBorders = (src: cv.Mat, binary: cv.Mat): cv.Mat | null => {\n  const cellCenter = [Math.round(binary.rows / 2), Math.round(binary.cols / 2)] as Point;\n  const cellArea = binary.rows * binary.cols;\n  const minArea = MIN_CHAR_AREA * cellArea;\n  const maxArea = MAX_CHAR_AREA * cellArea;\n  const contours = new cv.MatVector();\n  const hierarchy = new cv.Mat();\n\n  cv.findContours(binary, contours, hierarchy, cv.RETR_TREE, cv.CHAIN_APPROX_SIMPLE);\n  hierarchy.delete();\n\n  let largestArea = 0;\n  let largestRect = null;\n\n  for (let i = 0; i < contours.size(); i++) {\n    const contour = contours.get(i);\n    const rect = cv.boundingRect(contour);\n    const area = rect.width * rect.height;\n    const shapeRatio = rect.width / rect.height;\n\n    if (\n      area > minArea &&\n      area < maxArea &&\n      shapeRatio > MIN_CHAR_ASPECT_RATIO &&\n      shapeRatio < MAX_CHAR_ASPECT_RATIO &&\n      isPointInsideRect(cellCenter, rect) &&\n      area > largestArea\n    ) {\n      largestArea = area;\n      largestRect = rect;\n    }\n    contour.delete();\n  }\n\n  if (largestRect !== null) {\n    // OCR really is expensive, so anything we can do before it to eliminate empty cells, generally\n    // saves a lot of work.\n    const binaryCellContents = binary.roi(largestRect);\n    const isCellEmpty = isEmpty(binaryCellContents);\n    binaryCellContents.delete();\n\n    if (!isCellEmpty) {\n      // Padding the contents helps OCR.\n      const padding = Math.round(CHAR_PADDING * cellArea ** (1 / 2));\n\n      // TODO: Explore \"column walking\" method, to identify true upper bounds\n      //      (count at least ~5% black pixels in row, to disambiguate noise?)\n      largestRect.x = Math.max(largestRect.x - padding, 0);\n      largestRect.y = Math.max(largestRect.y - padding, 0);\n\n      // TODO: Pad tall-thin characters' width a bit more?\n      largestRect.width = Math.min(largestRect.width + 2 * padding, src.cols - largestRect.x);\n      largestRect.height = Math.min(largestRect.height + 2 * padding, src.rows - largestRect.y);\n\n      contours.delete();\n      return src.roi(largestRect);\n    }\n  }\n  contours.delete();\n  return null;\n};\n","import isNode from 'detect-node';\n\nimport SudokuScannerInterface, {\n  SudokuDigitImages,\n  SudokuScannerConfig,\n} from '../../types/interfaces/SudokuScanner';\nimport { loadScript } from '../../util/browser';\nimport {\n  cropAndFlatten,\n  cropCellBorders,\n  isContourSquarish,\n  simplifyContour,\n  split,\n} from '../lib/cv';\n\n/**\n * Locates and extracts Sudoku puzzles from a supplied image.\n */\nexport default class SudokuScanner implements SudokuScannerInterface {\n  /** @inheritDoc */\n  protected readonly config: SudokuScannerConfig = {\n    rows: 9,\n    columns: 9,\n    preprocess: {\n      blurRadius: 11,\n      thresholdBlur: 5,\n      thresholdNorm: 2,\n    },\n    minSize: 0.25,\n    maxSize: 0.99,\n  };\n\n  /** The original, unmodified copy we will keep; so that we can later return a clean image. */\n  protected original: cv.Mat;\n  /** The source image, which will be modified for image analysis.  */\n  protected source: cv.Mat;\n  /** The processed versions of the image (undefined, if scan() hasn't been called yet).  */\n  protected processed?: {\n    /** A cropped version of the original image (useful for rendering in a UI). */\n    colour: cv.Mat;\n    /** A black & white copy, to avoid having to redo the image processing in subsequent stages. */\n    binary: cv.Mat;\n  } | null;\n\n  /**\n   * Loads the image to be scanned and applies custom config values, if supplied.\n   */\n  constructor(source: HTMLCanvasElement | ImageData, config?: Partial<SudokuScannerConfig>) {\n    if (!cv) throw new Error('OpenCV must be loaded!');\n\n    this.original =\n      source.constructor.name === 'ImageData' ? cv.matFromImageData(source) : cv.imread(source);\n    this.source = this.original.clone();\n    this.config = { ...this.config, ...config };\n  }\n\n  /** @inheritDoc */\n  public extractSudokuImage(outputCanvas?: HTMLCanvasElement): boolean {\n    // TODO: Check if image is too blurry (see: https://github.com/justadudewhohacks/opencv4nodejs/issues/448)\n    this.preprocessImage();\n    const largestSquare = this.findLargestSquare();\n\n    if (largestSquare !== null) {\n      this.processed = {\n        colour: cropAndFlatten(this.original, largestSquare),\n        binary: cropAndFlatten(this.source, largestSquare),\n      };\n\n      largestSquare.delete();\n      this.original.delete();\n      this.source.delete();\n\n      outputCanvas && cv.imshow(outputCanvas, this.processed.colour);\n      return true;\n    }\n\n    this.processed = null;\n    return false;\n  }\n\n  /** @inheritDoc */\n  public extractDigits(): SudokuDigitImages | null {\n    // If we didn't find a Sudoku, then we won't find any digits...\n    if (this.processed === null) return null;\n\n    // If we haven't scanned the image for Sudokus yet, we need to...\n    if (this.processed === undefined) {\n      this.extractSudokuImage();\n      return this.extractDigits();\n    }\n\n    const originalCells = split(this.processed.colour, this.config.rows, this.config.columns);\n    const binaryCells = split(this.processed.binary, this.config.rows, this.config.columns);\n    const grid: (HTMLCanvasElement | null)[][] = [];\n\n    for (let r = 0; r < this.config.rows; r++) {\n      const row = [];\n\n      for (let c = 0; c < this.config.columns; c++) {\n        const colourCell = originalCells[r][c];\n        const binaryCell = binaryCells[r][c];\n        const digitMat = cropCellBorders(colourCell, binaryCell);\n\n        if (digitMat) {\n          const canvas = document.createElement('canvas');\n          row.push(canvas);\n          cv.imshow(canvas, digitMat);\n\n          digitMat.delete();\n        } else row.push(null);\n\n        colourCell.delete();\n        binaryCell.delete();\n      }\n\n      grid.push(row);\n    }\n\n    return grid;\n  }\n\n  /** @inheritDoc */\n  public destruct(): void {\n    // If the image has been processed, then the this.original and this.source matrices have already\n    // been deleted.\n    if (this.processed) {\n      this.processed.colour.delete();\n      this.processed.binary.delete();\n    } else {\n      this.original.delete();\n      this.source.delete();\n    }\n  }\n\n  /**\n   * Applies image thresholding, to make the source image as close to black & white \"line art\" as\n   * possible (i.e. with the goal of finding contiguous lines, with minimal noise).\n   */\n  protected preprocessImage(): void {\n    const { blurRadius, thresholdBlur, thresholdNorm } = this.config.preprocess;\n\n    // Grayscale, to help line-identification.\n    cv.cvtColor(this.source, this.source, cv.COLOR_RGBA2GRAY, 0);\n    // Blur, to smooth out noise.\n    const blurKernel = new cv.Size(blurRadius, blurRadius);\n    cv.GaussianBlur(this.source, this.source, blurKernel, 0, 0, cv.BORDER_DEFAULT);\n    // Convert to black & white.\n    cv.adaptiveThreshold(\n      this.source,\n      this.source,\n      255, // black\n      cv.ADAPTIVE_THRESH_MEAN_C,\n      cv.THRESH_BINARY,\n      thresholdBlur,\n      thresholdNorm\n    );\n  }\n\n  /**\n   * Finds the contour (shape, in OpenCV) surrounding the largest Sudoku-like square in the source\n   * image.\n   */\n  protected findLargestSquare(): cv.Mat | null {\n    const contours = new cv.MatVector();\n    const hierarchy = new cv.Mat();\n\n    cv.findContours(this.source, contours, hierarchy, cv.RETR_TREE, cv.CHAIN_APPROX_SIMPLE);\n\n    let largestArea = 0;\n    let largestSquare = null;\n\n    for (let i = 0; i < contours.size(); i++) {\n      const contour = contours.get(i);\n      const simplified = simplifyContour(contour);\n\n      // TODO: Add additional constraints, e.g.parallel Hough lines, to reduce false positives?\n      if (isContourSquarish(simplified, this.source, this.config.minSize, this.config.maxSize)) {\n        const area = cv.contourArea(simplified);\n        if (area > largestArea) {\n          largestArea = area;\n          largestSquare = simplified.clone();\n        }\n      }\n      contour.delete();\n      simplified.delete();\n    }\n\n    contours.delete();\n    hierarchy.delete();\n\n    return largestSquare;\n  }\n\n  /**\n   * Loads the Scanner's dependencies in a browser context (please note, this must be done manually\n   * if using node). This must be have resolved before the class is used.\n   *\n   * @param timeLimit The time, in ms, after which an Error will be thrown, if the dependencies have\n   *                  not loaded.\n   */\n  static async loadDependencies(timeLimit?: number): Promise<void> {\n    if (isNode || typeof cv !== 'undefined') return Promise.resolve();\n\n    return loadScript('opencv.js', timeLimit);\n  }\n}\n","import { cover } from 'intrinsic-scale';\nimport { RefObject, useCallback, useEffect, useState } from 'react';\n\nimport { SudokuScanner as SudokuScannerService } from '../services';\nimport { SudokuDigitImages } from '../types/interfaces/SudokuScanner';\n\n// This results in an optimal character height for OCR, see:  https://groups.google.com/g/tesseract-ocr/c/Wdh_JJwnw94/m/24JHDYQbBQAJ\nconst SUDOKU_SIZE = 540;\nconst buffer = document.createElement('canvas');\nbuffer.width = SUDOKU_SIZE;\nbuffer.height = SUDOKU_SIZE;\n\nconst getFrame = (video: HTMLVideoElement, mask: HTMLElement): ImageData | null => {\n  const { width: displayWidth, height: displayHeight } = video.getBoundingClientRect();\n  const { width: scaledWidth, height: scaledHeight, x: cropX, y: cropY } = cover(\n    displayWidth,\n    displayHeight,\n    video.videoWidth,\n    video.videoHeight\n  );\n  const scale = cropX ? video.videoHeight / scaledHeight : video.videoWidth / scaledWidth;\n  const videoMask = {\n    x: scale * (mask.offsetLeft - video.offsetLeft - cropX),\n    y: scale * (mask.offsetTop - video.offsetTop - cropY),\n    width: scale * mask.offsetWidth,\n    height: scale * mask.offsetHeight,\n  };\n\n  const ctx = buffer.getContext('2d');\n  if (!ctx) return null;\n\n  ctx.drawImage(\n    video,\n    videoMask.x,\n    videoMask.y,\n    videoMask.width,\n    videoMask.height,\n    0,\n    0,\n    buffer.width,\n    buffer.height\n  );\n\n  return ctx.getImageData(0, 0, buffer.width, buffer.height);\n};\n\nexport default function useScanner(\n  source: RefObject<HTMLVideoElement>,\n  output: RefObject<HTMLCanvasElement>,\n  scanHz = 30\n): [boolean | null, SudokuDigitImages | null] {\n  const [scannerLoaded, setScannerLoaded] = useState<boolean | null>(null);\n  const [digitImages, setDigitImages] = useState<SudokuDigitImages | null>(null);\n\n  // Continuously scan the source video, until a sudoku-like image is found.\n  const scanSource = useCallback(() => {\n    const start = Date.now();\n    let found = false;\n\n    if (source.current && output.current) {\n      const frame = getFrame(source.current, output.current);\n      if (frame) {\n        const scanner = new SudokuScannerService(frame);\n        found = scanner.extractSudokuImage(output.current);\n        found && setDigitImages(scanner.extractDigits());\n        scanner.destruct();\n      }\n    }\n\n    const timeTaken = Date.now() - start;\n    !found && setTimeout(scanSource, 1000 / scanHz - timeTaken);\n  }, [output, scanHz, source]);\n\n  useEffect(() => {\n    if (scannerLoaded === null) {\n      SudokuScannerService.loadDependencies().then(() => {\n        // Prevent blocking the main thread for too long, so the browser doesn't think we're mining\n        // bitcoin! ðŸ˜†\n        setTimeout(scanSource, 100);\n        setScannerLoaded(true);\n      });\n      setScannerLoaded(false);\n    }\n  }, [scanSource, scannerLoaded]);\n\n  return [scannerLoaded, digitImages];\n}\n","import styles from './Ellipsis.module.scss';\n\nexport default function Ellipsis() {\n  return (\n    <span>\n      <span className={styles.one}>.</span>\n      <span className={styles.two}>.</span>\n      <span className={styles.three}>.</span>\n    </span>\n  );\n}\n","import styles from './LoadingBlocks.module.scss';\n\nexport default function LoadingBlocks() {\n  return (\n    <div className={styles.loadingBlocks}>\n      <span className={styles.block1} />\n      <span className={styles.block2} />\n      <span className={styles.block3} />\n      <span className={styles.block4} />\n      <span className={styles.block5} />\n      <span className={styles.block6} />\n      <span className={styles.block7} />\n      <span className={styles.block8} />\n      <span className={styles.block9} />\n    </div>\n  );\n}\n","import { RefObject, useEffect, useRef } from 'react';\n\nimport { useReader, useScanner } from '../hooks';\nimport { Sudoku } from '../types/interfaces/SudokuSolver';\nimport { Ellipsis, LoadingBlocks } from './Animations';\nimport styles from './SudokuScanner.module.scss';\n\n/**\n * Visual UI, designed to be rendered on top of the <video> element that is its source. The video\n * source is scanned for Sudoku-like objects.\n */\nexport default function SudokuScanner({ source, onFound, scanHz }: Props) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [scannerLoaded, digitImages] = useScanner(source, canvasRef, scanHz);\n  const [readerLoaded, sudoku] = useReader(digitImages);\n\n  let loadingMessage = '';\n  if (!scannerLoaded) loadingMessage = 'Please wait while the scanner loads';\n  else if (digitImages && !readerLoaded) loadingMessage = 'Please wait while the reader loads';\n\n  useEffect(() => {\n    sudoku && onFound(sudoku);\n  }, [onFound, sudoku]);\n\n  // Both the SudokuScanner and TextReader have large (~10+ MB) dependencies to load (which, even\n  // if cached, can still take several seconds to parse). We want to make the experience seem as\n  // fast as possible for the user; so we proceed as far as we can at each step, before hitting a\n  // roadblock (where we are forced to display a \"this library is loading...\" message).\n  return (\n    <div className={styles.sudokuScanner}>\n      <canvas ref={canvasRef} />\n      {loadingMessage && (\n        <div className={styles.loadingMessage}>\n          <LoadingBlocks />\n          <span>\n            {loadingMessage}\n            <Ellipsis />\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}\n\ntype Props = {\n  source: RefObject<HTMLVideoElement>;\n  onFound(sudoku: Sudoku): void;\n  scanHz?: number;\n};\n","import { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { TextReader } from '../services';\nimport { SudokuDigitImages } from '../types/interfaces/SudokuScanner';\nimport { Sudoku } from '../types/interfaces/SudokuSolver';\n\nexport default function useReader(\n  digitImages: SudokuDigitImages | null\n): [boolean | null, Sudoku | null] {\n  const [readerLoaded, setReaderLoaded] = useState<boolean | null>(null);\n  const [sudoku, setSudoku] = useState<Sudoku | null>(null);\n  const digitReader = useMemo(() => new TextReader({ whitelist: '123456789', single: true }), []);\n\n  /**\n   * Runs OCR on `digitImages`, if is populated. The resulting 2D array of numbers, is used to\n   * build a Sudoku object, which is returned to the parent via `onFound()`.\n   */\n  const readPendingDigits = useCallback(\n    () =>\n      digitImages &&\n      Promise.all(\n        digitImages.map(row =>\n          Promise.all(row.map(digit => (digit ? digitReader.read(digit) : '')))\n        )\n      ).then(setSudoku),\n    [digitImages, digitReader]\n  );\n\n  useEffect(() => {\n    if (readerLoaded === null) {\n      digitReader.load().then(() => {\n        readPendingDigits();\n        setReaderLoaded(true);\n      });\n      setReaderLoaded(false);\n    }\n    readerLoaded && readPendingDigits();\n  }, [digitImages, digitReader, readPendingDigits, readerLoaded]);\n\n  useEffect(\n    () => () => {\n      // It's safer to call the destructor here, in case the component is unmounted before a sudoku\n      // is found.\n      digitReader.destruct(); // TODO: Move scanner and reader into global or parent state.\n    },\n    [digitReader]\n  );\n\n  return [readerLoaded, sudoku];\n}\n","import { Sudoku } from '../types/interfaces/SudokuSolver';\nimport styles from './SudokuSolver.module.scss';\n\nexport default function SudokuSolver({ sudoku }: { sudoku: Sudoku }) {\n  let i = 0;\n  return (\n    <table className={styles.sudokuSolver}>\n      <tbody>\n        {sudoku.map(row => (\n          <tr key={i}>\n            {row.map(cell => (\n              // eslint-disable-next-line no-plusplus -- ðŸ™„\n              <td key={i++}>{cell}</td>\n            ))}\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n}\n","import styles from './Overlay.module.scss';\n\nexport default function Overlay({ corners }: { corners: boolean }) {\n  return (\n    <div className={styles.overlay} role=\"application\">\n      {corners && (\n        <>\n          <div className={`${styles.corner} ${styles.top} ${styles.left}`} />\n          <div className={`${styles.corner} ${styles.top} ${styles.right}`} />\n          <div className={`${styles.corner} ${styles.bottom} ${styles.left}`} />\n          <div className={`${styles.corner} ${styles.bottom} ${styles.right}`} />\n        </>\n      )}\n    </div>\n  );\n}\n","import { useRef, useState } from 'react';\n\nimport styles from './App.module.scss';\nimport { Camera, CameraStatus, Overlay, SudokuScanner, SudokuSolver } from './components';\nimport { Sudoku } from './types/interfaces/SudokuSolver';\n\nexport default function App() {\n  const [cameraStatus, setCameraStatus] = useState(CameraStatus.Loading);\n  const [sudoku, setSudoku] = useState<Sudoku | null>(null);\n  const videoRef = useRef<HTMLVideoElement>(null);\n\n  return (\n    <div className={styles.app}>\n      <header>\n        <h1>ðŸ§® Sudoku Solver</h1>\n      </header>\n      <Camera ref={videoRef} onStatusUpdate={setCameraStatus} />\n      <main>\n        {cameraStatus === CameraStatus.Active && !sudoku && (\n          <SudokuScanner source={videoRef} scanHz={10} onFound={setSudoku} />\n        )}\n        {sudoku && <SudokuSolver sudoku={sudoku} />}\n        <Overlay corners={!sudoku} />\n      </main>\n      <footer>\n        <nav>\n          {sudoku && (\n            <button type=\"button\" onClick={() => setSudoku(null)}>\n              Reset\n            </button>\n          )}\n        </nav>\n        <p>\n          ðŸ“Ÿ{' '}\n          <a href=\"https://github.com/SamChristy/sudoku-solver\" target=\"_blank\" rel=\"noreferrer\">\n            see code\n          </a>\n        </p>\n      </footer>\n    </div>\n  );\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL || '', window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import './index.scss';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\nimport { fixViewportHeightInMobileSafari, loadMobileConsole } from './util/browser';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nwindow.location.search.includes('console') && loadMobileConsole();\nfixViewportHeightInMobileSafari();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.unregister();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}