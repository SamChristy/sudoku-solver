(this["webpackJsonpsudoku-solver"]=this["webpackJsonpsudoku-solver"]||[]).push([[0],{19:function(e,t,n){e.exports={one:"Ellipsis_one__zElG3",ellipsis:"Ellipsis_ellipsis__3jNN6",two:"Ellipsis_two__2xLtj",three:"Ellipsis_three__3hdzz"}},25:function(e,t,n){e.exports={app:"SudokuScanner_app__39mV1",sudokuScanner:"SudokuScanner_sudokuScanner__3ToCZ",loadingMessage:"SudokuScanner_loadingMessage__1RgGF"}},27:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r=n(1),c=n.n(r),a=n(5),o=n(8),i=n(9),s=n(10),u=n(18),l=n.n(u),d=n(39),h=n.n(d),v=n(24),f=function(){function t(n){var r=this;Object(i.a)(this,t),this.scheduler=void 0,this.language="eng",this.config={threadCount:2,whitelist:"",single:!1},this.getTesseractConfig=function(){var t=null!=="lib"?"lib":"";return{tesseractConfig:{user_defined_dpi:"300",tessedit_ocr_engine_mode:2,tessedit_pageseg_mode:r.config.single?"10":void 0,tessedit_char_whitelist:r.config.whitelist||void 0},workerConfig:l.a?{langPath:h.a.join(e,"..","..","..","public",t,"ocr"),cacheMethod:"none",gzip:!0}:{langPath:"".concat("/sudoku-solver","/").concat(t,"/ocr"),workerPath:"".concat("/sudoku-solver","/").concat(t,"/ocr/worker.min.js"),corePath:"".concat("/sudoku-solver","/").concat(t,"/ocr/tesseract-core.wasm.js")}}},this.config=Object(o.a)(Object(o.a)({},this.config),n),this.scheduler=Object(v.createScheduler)()}return Object(s.a)(t,[{key:"load",value:function(){var e=Object(a.a)(c.a.mark((function e(){var t,n,r,o,i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getTesseractConfig(),n=t.workerConfig,r=t.tesseractConfig,o=function(){var e=Object(a.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(v.createWorker)(n),e.next=3,t.load();case 3:return e.next=5,t.loadLanguage(i.language);case 5:return e.next=7,t.initialize(i.language);case 7:return e.next=9,t.setParameters(r);case 9:i.scheduler.addWorker(t);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=4,Promise.allSettled(Array(this.config.threadCount).fill(0).map(o));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=Object(a.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scheduler.addJob("recognize",t);case 2:return n=e.sent,r=n.data.text,e.abrupt("return",r.slice(0,this.config.single?1:r.length-1));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destruct",value:function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scheduler.terminate();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}()}).call(this,"/")},36:function(e,t,n){e.exports={app:"App_app__2ziFi"}},37:function(e,t,n){e.exports={camera:"Camera_camera__1ODM1"}},4:function(e,t,n){e.exports={app:"Overlay_app__3lk76",overlay:"Overlay_overlay__3vGmN",corner:"Overlay_corner__1TZHo",top:"Overlay_top__1gty1",left:"Overlay_left__3L_DC",right:"Overlay_right___Zrwb",bottom:"Overlay_bottom__v5eaf"}},41:function(e,t,n){e.exports={app:"SudokuSolver_app__oOmwd",sudokuSolver:"SudokuSolver_sudokuSolver__10dvD"}},42:function(e,t,n){},6:function(e,t,n){e.exports={app:"LoadingBlocks_app__-G7ER",loadingBlocks:"LoadingBlocks_loadingBlocks__WdlnC",load:"LoadingBlocks_load__2vBzM",block1:"LoadingBlocks_block1__3UdgJ",block2:"LoadingBlocks_block2__2F5y7",block3:"LoadingBlocks_block3__2dRof",block4:"LoadingBlocks_block4__2bBin",block5:"LoadingBlocks_block5__3LT2j",block6:"LoadingBlocks_block6__1ZCCM",block7:"LoadingBlocks_block7__3yVzZ",block8:"LoadingBlocks_block8__1q1wE",block9:"LoadingBlocks_block9__1MBjw"}},78:function(e,t,n){"use strict";n.r(t);n(42);var r,c=n(2),a=n.n(c),o=n(35),i=n.n(o),s=n(3),u=n(36),l=n.n(u),d=n(8),h=n(1),v=n.n(h),f=n(5),p={width:{ideal:2048},height:{ideal:1080},facingMode:{ideal:"environment"},focusMode:{ideal:"continuous"},whiteBalance:{ideal:"continuous"},exposureMode:{ideal:"continuous"}},b=function(){var e=Object(f.a)(v.a.mark((function e(){var t,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:if(t=e.sent,(n=t.filter((function(e){return"videoinput"===e.kind}))).length){e.next=6;break}throw new Error("No camera found.");case 6:return r=n.filter((function(e){return e.label.includes("facing back")})),e.abrupt("return",r.length?r[r.length-1]:null);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(f.a)(v.a.mark((function e(t,n){var r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:return r=e.sent,c={video:Object(d.a)(Object(d.a)({},p),{},{deviceId:(null===r||void 0===r?void 0:r.deviceId)?r.deviceId:void 0},n&&{width:{ideal:n.width},height:{ideal:n.height}}),audio:!1},e.next=6,navigator.mediaDevices.getUserMedia(c);case 6:return t.srcObject=e.sent,e.next=9,t.play();case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),j=n(37),m=n.n(j),_=n(0);!function(e){e[e.Loading=0]="Loading",e[e.Active=1]="Active",e[e.Denied=2]="Denied",e[e.Unavailable=3]="Unavailable"}(r||(r={}));var O,w=Object(c.forwardRef)((function(e,t){var n=e.onStatusUpdate;return Object(c.useEffect)((function(){var e=t.current;return e?(g(e).catch((function(e){var t=e.name;return n("NotAllowedError"===t?r.Denied:r.Unavailable)})),function(){e.srcObject.getVideoTracks()[0].stop()}):function(){}}),[n,t]),Object(_.jsx)("video",{className:m.a.camera,ref:t,onLoadedMetadata:function(){return n(r.Active)},onSuspend:function(){return n(r.Unavailable)},playsInline:!0,muted:!0})})),k=n(9),x=n(10),y=n(18),S=n.n(y),M=n(38),C=Object(M.a)(),E=parseFloat(null!==(O="20000")?O:"")||1e4,N=function(){var e=Object(f.a)(v.a.mark((function e(t){var n,r,c=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:E,(r=document.createElement("script")).defer=!0,t.startsWith("http")?r.src=t:r.src="".concat("/sudoku-solver","/").concat("lib","/").concat(t),document.body.appendChild(r),e.abrupt("return",new Promise((function(e,c){var a=window.setTimeout((function(){return c(new Error("".concat(t," failed to load in time")))}),n);r.addEventListener("load",(function(){window.clearTimeout(a),e()}))})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(f.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N("mobileConsole.js");case 2:eruda.init();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=n(15),B=function(e,t){var n=Object(s.a)(e,2),r=n[0],c=n[1],a=Object(s.a)(t,2),o=a[0],i=a[1];return Math.pow(Math.pow(r-o,2)+Math.pow(c-i,2),.5)},A=function(e,t){var n=t.map((function(t){return B(e,t)})),r=n[0];return t.reduce((function(e,t,c){return n[c]<r?(r=n[c],t):e}))},T=function(e){return e.map((function(t,n){return B(t,e[n<e.length-1?n+1:0])}))},D=function(e,t){return e[0]>=t.x&&e[1]>=t.y&&e[0]<=t.x+t.width&&e[0]<=t.y+t.height},P=function(e){for(var t=Array.from(e.data32S),n=Array(4),r=0;r<4;r++)n[r]=t.slice(2*r,2*r+2);return n},I=function(e){var t=new cv.Mat,n=.01*cv.arcLength(e,!0);return cv.approxPolyDP(e,t,n,!0),t},z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(4!==e.size().height)return!1;if(!t)return!0;var c=Math.pow(Math.min(t.rows,t.cols),2)*n,a=Math.max(t.rows,t.cols)*r;if(cv.contourArea(e)>=c){var o=P(e),i=T(o).sort(),s=i.pop();return!!s&&(s<a&&i.every((function(e){return e>.7*s})))}return!1},F=function(e,t){var n=[e.cols,e.rows],r=n[0],c=n[1],a=P(t),o=A([0,0],a),i=A([r,0],a),s=A([0,c],a),u=A([r,c],a),l=Math.min(i[0]-o[0],u[0]-s[0]),d=Math.min(s[1]-o[1],u[1]-i[1]),h=cv.Mat.zeros(l,d,cv.CV_8UC3),v=new cv.Size(l,d),f=cv.matFromArray(4,1,cv.CV_32FC2,[].concat(Object(R.a)(o),Object(R.a)(i),Object(R.a)(u),Object(R.a)(s))),p=cv.matFromArray(4,1,cv.CV_32FC2,[0,0,l,0,l,d,0,d]),b=cv.getPerspectiveTransform(f,p);return cv.warpPerspective(e,h,b,v,cv.INTER_LINEAR,cv.BORDER_CONSTANT),b.delete(),f.delete(),p.delete(),h},H=function(e,t,n){for(var r=new Array(t),c=e.cols/n,a=e.rows/t,o=0;o<t;o++){r[o]=new Array(n);for(var i=0;i<n;i++){var s=i*c,u=o*a,l=new cv.Rect(s,u,c,a);r[o][i]=e.roi(l)}}return r},V=function(e,t){var n=[Math.round(t.rows/2),Math.round(t.cols/2)],r=t.rows*t.cols,c=.08*r,a=.8*r,o=new cv.MatVector,i=new cv.Mat;cv.findContours(t,o,i,cv.RETR_TREE,cv.CHAIN_APPROX_SIMPLE),i.delete();for(var s=0,u=null,l=0;l<o.size();l++){var d=o.get(l),h=cv.boundingRect(d),v=h.width*h.height,f=h.width/h.height;v>c&&v<a&&f>.2&&f<1.6&&D(n,h)&&v>s&&(s=v,u=h),d.delete()}if(null!==u){var p=t.roi(u),b=function(e){var t=new cv.Mat(1,4,cv.CV_64F),n=new cv.Mat(1,4,cv.CV_64F);return cv.meanStdDev(e,t,n),t.doubleAt(0,0)>=230}(p);if(p.delete(),!b){var g=Math.round(.05*Math.pow(r,.5));return u.x=Math.max(u.x-g,0),u.y=Math.max(u.y-g,0),u.width=Math.min(u.width+2*g,e.cols-u.x),u.height=Math.min(u.height+2*g,e.rows-u.y),o.delete(),e.roi(u)}}return o.delete(),null},U=function(){function e(t,n){if(Object(k.a)(this,e),this.config={rows:9,columns:9,preprocess:{blurRadius:11,thresholdBlur:5,thresholdNorm:2},minSize:.25,maxSize:.99},this.original=void 0,this.source=void 0,this.processed=void 0,!cv)throw new Error("OpenCV must be loaded!");this.original="ImageData"===t.constructor.name?cv.matFromImageData(t):cv.imread(t),this.source=this.original.clone(),this.config=Object(d.a)(Object(d.a)({},this.config),n)}return Object(x.a)(e,[{key:"extractSudokuImage",value:function(e){this.preprocessImage();var t=this.findLargestSquare();return null!==t?(this.processed={colour:F(this.original,t),binary:F(this.source,t)},t.delete(),this.original.delete(),this.source.delete(),e&&cv.imshow(e,this.processed.colour),!0):(this.processed=null,!1)}},{key:"extractDigits",value:function(){if(null===this.processed)return null;if(void 0===this.processed)return this.extractSudokuImage(),this.extractDigits();for(var e=H(this.processed.colour,this.config.rows,this.config.columns),t=H(this.processed.binary,this.config.rows,this.config.columns),n=[],r=0;r<this.config.rows;r++){for(var c=[],a=0;a<this.config.columns;a++){var o=e[r][a],i=t[r][a],s=V(o,i);if(s){var u=document.createElement("canvas");c.push(u),cv.imshow(u,s),s.delete()}else c.push(null);o.delete(),i.delete()}n.push(c)}return n}},{key:"destruct",value:function(){this.processed?(this.processed.colour.delete(),this.processed.binary.delete()):(this.original.delete(),this.source.delete())}},{key:"preprocessImage",value:function(){var e=this.config.preprocess,t=e.blurRadius,n=e.thresholdBlur,r=e.thresholdNorm;cv.cvtColor(this.source,this.source,cv.COLOR_RGBA2GRAY,0);var c=new cv.Size(t,t);cv.GaussianBlur(this.source,this.source,c,0,0,cv.BORDER_DEFAULT),cv.adaptiveThreshold(this.source,this.source,255,cv.ADAPTIVE_THRESH_MEAN_C,cv.THRESH_BINARY,n,r)}},{key:"findLargestSquare",value:function(){var e=new cv.MatVector,t=new cv.Mat;cv.findContours(this.source,e,t,cv.RETR_TREE,cv.CHAIN_APPROX_SIMPLE);for(var n=0,r=null,c=0;c<e.size();c++){var a=e.get(c),o=I(a);if(z(o,this.source,this.config.minSize,this.config.maxSize)){var i=cv.contourArea(o);i>n&&(n=i,r=o.clone())}a.delete(),o.delete()}return e.delete(),t.delete(),r}}],[{key:"loadDependencies",value:function(){var e=Object(f.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S.a&&"undefined"===typeof cv){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.abrupt("return",N("opencv.js",t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),W=n(27);var G=n(40),Z=document.createElement("canvas");Z.width=540,Z.height=540;var J=function(e,t){var n=e.getBoundingClientRect(),r=n.width,c=n.height,a=Object(G.cover)(r,c,e.videoWidth,e.videoHeight),o=a.width,i=a.height,s=a.x,u=a.y,l=s?e.videoHeight/i:e.videoWidth/o,d={x:l*(t.offsetLeft-e.offsetLeft-s),y:l*(t.offsetTop-e.offsetTop-u),width:l*t.offsetWidth,height:l*t.offsetHeight},h=Z.getContext("2d");return h?(h.drawImage(e,d.x,d.y,d.width,d.height,0,0,Z.width,Z.height),h.getImageData(0,0,Z.width,Z.height)):null};var q=n(19),X=n.n(q);function Y(){return Object(_.jsxs)("span",{children:[Object(_.jsx)("span",{className:X.a.one,children:"."}),Object(_.jsx)("span",{className:X.a.two,children:"."}),Object(_.jsx)("span",{className:X.a.three,children:"."})]})}var $=n(6),K=n.n($);function Q(){return Object(_.jsxs)("div",{className:K.a.loadingBlocks,children:[Object(_.jsx)("span",{className:K.a.block1}),Object(_.jsx)("span",{className:K.a.block2}),Object(_.jsx)("span",{className:K.a.block3}),Object(_.jsx)("span",{className:K.a.block4}),Object(_.jsx)("span",{className:K.a.block5}),Object(_.jsx)("span",{className:K.a.block6}),Object(_.jsx)("span",{className:K.a.block7}),Object(_.jsx)("span",{className:K.a.block8}),Object(_.jsx)("span",{className:K.a.block9})]})}var ee=n(25),te=n.n(ee);function ne(e){var t=e.source,n=e.onFound,r=e.scanHz,a=Object(c.useRef)(null),o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,r=Object(c.useState)(null),a=Object(s.a)(r,2),o=a[0],i=a[1],u=Object(c.useState)(null),l=Object(s.a)(u,2),d=l[0],h=l[1],v=Object(c.useCallback)((function(){var r=Date.now(),c=!1;if(e.current&&t.current){var a=J(e.current,t.current);if(a){var o=new U(a);(c=o.extractSudokuImage(t.current))&&h(o.extractDigits()),o.destruct()}}var i=Date.now()-r;!c&&setTimeout(v,1e3/n-i)}),[t,n,e]);return Object(c.useEffect)((function(){null===o&&(U.loadDependencies().then((function(){setTimeout(v,100),i(!0)})),i(!1))}),[v,o]),[o,d]}(t,a,r),i=Object(s.a)(o,2),u=i[0],l=i[1],d=function(e){var t=Object(c.useState)(null),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(null),i=Object(s.a)(o,2),u=i[0],l=i[1],d=Object(c.useMemo)((function(){return new W.a({whitelist:"123456789",single:!0})}),[]),h=Object(c.useCallback)((function(){return e&&Promise.all(e.map((function(e){return Promise.all(e.map((function(e){return e?d.read(e):""})))}))).then(l)}),[e,d]);return Object(c.useEffect)((function(){null===r&&(d.load().then((function(){h(),a(!0)})),a(!1)),r&&h()}),[e,d,h,r]),Object(c.useEffect)((function(){return function(){d.destruct()}}),[d]),[r,u]}(l),h=Object(s.a)(d,2),v=h[0],f=h[1],p="";return u?l&&!v&&(p="Please wait while the reader loads"):p="Please wait while the scanner loads",Object(c.useEffect)((function(){f&&n(f)}),[n,f]),Object(_.jsxs)("div",{className:te.a.sudokuScanner,children:[Object(_.jsx)("canvas",{ref:a}),p&&Object(_.jsxs)("div",{className:te.a.loadingMessage,children:[Object(_.jsx)(Q,{}),Object(_.jsxs)("span",{children:[p,Object(_.jsx)(Y,{})]})]})]})}var re=n(41),ce=n.n(re);function ae(e){var t=e.sudoku,n=0;return Object(_.jsx)("table",{className:ce.a.sudokuSolver,children:Object(_.jsx)("tbody",{children:t.map((function(e){return Object(_.jsx)("tr",{children:e.map((function(e){return Object(_.jsx)("td",{children:e},n++)}))},n)}))})})}var oe=n(4),ie=n.n(oe);function se(e){var t=e.corners;return Object(_.jsx)("div",{className:ie.a.overlay,role:"application",children:t&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:"".concat(ie.a.corner," ").concat(ie.a.top," ").concat(ie.a.left)}),Object(_.jsx)("div",{className:"".concat(ie.a.corner," ").concat(ie.a.top," ").concat(ie.a.right)}),Object(_.jsx)("div",{className:"".concat(ie.a.corner," ").concat(ie.a.bottom," ").concat(ie.a.left)}),Object(_.jsx)("div",{className:"".concat(ie.a.corner," ").concat(ie.a.bottom," ").concat(ie.a.right)})]})})}function ue(){var e=Object(c.useState)(r.Loading),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)(null),i=Object(s.a)(o,2),u=i[0],d=i[1],h=Object(c.useRef)(null);return Object(_.jsxs)("div",{className:l.a.app,children:[Object(_.jsx)("header",{children:Object(_.jsx)("h1",{children:"\ud83e\uddee Sudoku Solver"})}),Object(_.jsx)(w,{ref:h,onStatusUpdate:a}),Object(_.jsxs)("main",{children:[n===r.Active&&!u&&Object(_.jsx)(ne,{source:h,scanHz:10,onFound:d}),u&&Object(_.jsx)(ae,{sudoku:u}),Object(_.jsx)(se,{corners:!u})]}),Object(_.jsx)("footer",{children:Object(_.jsx)("nav",{children:u&&Object(_.jsx)("button",{type:"button",onClick:function(){return d(null)},children:"Reset"})})})]})}var le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,79)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(_.jsx)(a.a.StrictMode,{children:Object(_.jsx)(ue,{})}),document.getElementById("root")),window.location.search.includes("console")&&L(),"iOS"===(null===C||void 0===C?void 0:C.os)&&"ios"===C.name&&window.addEventListener("resize",(function(){document.body.style.height="100vh"})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),le()}},[[78,1,2]]]);
//# sourceMappingURL=main.db6ce4b7.chunk.js.map